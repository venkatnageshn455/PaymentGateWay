<div class="payment-list-container">

  <!-- HEADER -->
  <h2 class="title">Payments</h2>

  <!-- TOP BAR (Add Payment left, User dropdown right) -->
  <div class="top-bar">
    <button class="add-btn" (click)="openAddPayment()">Add Payment</button>

    <div class="user-filter">
      <label>User:</label>
      <select [(ngModel)]="selectedUser" (ngModelChange)="onUserChange()">
        <option value="">All Users</option>
        <option *ngFor="let u of users" [value]="u">{{ u }}</option>
      </select>
    </div>
  </div>

  <div *ngIf="loading" class="loading">Loading payments...</div>

  <!-- TABLE -->
  <table *ngIf="!loading && payments.length > 0" class="payments-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>User</th>
        <th>Reference</th>
        <th>Client Request ID</th>
        <th>Amount</th>
        <th>Currency</th>
        <th>Created At</th>
        <th>Updated At</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let p of payments">
        <td>{{ p.id }}</td>
        <td>{{ p.userId }}</td>
        <td>{{ p.reference }}</td>
        <td>{{ p.clientRequestId }}</td>
        <td>{{ p.amount | number:'1.2-2' }}</td>
        <td>{{ p.currency }}</td>
        <td>{{ p.createdAt | date:'yyyy-MM-dd HH:mm:ss' }}</td>
        <td>{{ p.updatedAt ? (p.updatedAt | date:'yyyy-MM-dd HH:mm:ss') : '-' }}</td>

        <td>
          <button class="edit-btn" (click)="openEditPayment(p)">Edit</button>
          <button class="delete-btn" (click)="deletePayment(p.userId, p.id)">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="!loading && payments.length === 0" class="no-data">
    No payments found.
  </div>

  <!-- FULLSCREEN MODAL -->
<div *ngIf="isFormVisible" class="modal-overlay-full">
  <div class="modal-wrapper">
    <app-payment-form
      [row]="selectedRow"
      (close)="onFormClose($event)">
    </app-payment-form>
  </div>
</div>


</div>
